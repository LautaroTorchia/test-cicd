name: CD Pipeline - AplicaciÃ³n Empresarial

on:
  workflow_run:
    workflows: ["CI Pipeline - AplicaciÃ³n Empresarial"]
    types:
      - completed

jobs:
  package-and-version:
    name: ğŸ“¦ Empaquetar + ğŸ·ï¸ Versionar
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    steps:
      - name: Empaquetar artefacto Docker
        run: echo "Artefacto Docker generado"
      - name: Generar versiÃ³n SemVer
        run: echo "VersiÃ³n 1.0.0 generada y etiquetada"

  deploy-dev:
    name: ğŸš€ Despliegue Dev
    runs-on: ubuntu-latest
    needs: package-and-version
    steps:
      - name: Desplegar en Dev
        run: echo "AplicaciÃ³n desplegada en desarrollo"

  deploy-qa:
    name: ğŸ”¬ Despliegue QA
    runs-on: ubuntu-latest
    needs: deploy-dev
    steps:
      - name: Desplegar en QA
        run: echo "AplicaciÃ³n desplegada en QA"

  validations:
    name: ğŸ” Validaciones Post-QA
    runs-on: ubuntu-latest
    needs: deploy-qa
    steps:
      - name: Escaneo de Seguridad
        run: echo "Escaneo aprobado"
      - name: Pruebas de Performance
        run: echo "Rendimiento verificado"

  deploy-staging:
    name: ğŸ§ª Staging
    runs-on: ubuntu-latest
    needs: validations
    steps:
      - name: Desplegar en Staging
        run: echo "AplicaciÃ³n en entorno Staging"

  approval-and-prod:
    name: ğŸ›‚ AprobaciÃ³n â†’ ğŸ ProducciÃ³n
    runs-on: ubuntu-latest
    needs: deploy-staging
    steps:
      - name: AprobaciÃ³n Manual
        run: echo "AprobaciÃ³n concedida"
      - name: Despliegue en ProducciÃ³n
        run: echo "AplicaciÃ³n desplegada en ProducciÃ³n"

